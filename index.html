<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tra C·ª©u Gi√° ƒê·∫•t H√† N·ªôi 2026</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="project.css">
</head>
<body>

    <div class="main-container">
        
        <!-- Header -->
        <header class="app-header">
            <div class="brand-wrapper">
                <span class="logo-icon">üèõÔ∏è</span>
                <span style="font-weight: 700; color: var(--primary-dark)">LandPriceVN</span>
            </div>
            <h1>Tra C·ª©u Gi√° ƒê·∫•t <br>H√† N·ªôi 2026</h1>
            <!-- <p class="subtitle">·ª®ng d·ª•ng tra c·ª©u b·∫£ng gi√° ƒë·∫•t ch√≠nh th·ª©c m·ªõi nh·∫•t. D·ªØ li·ªáu ch√≠nh x√°c, c·∫≠p nh·∫≠t li√™n t·ª•c t·ª´ c∆° quan nh√† n∆∞·ªõc.</p> -->
        </header>

        <!-- Search -->
        <section class="search-section">
            <form id="searchForm" class="search-card">
                <div class="input-wrapper">
                    <i class="fa-solid fa-magnifying-glass search-icon"></i>
                    <input type="text" id="streetInput" placeholder="Nh·∫≠p t√™n ƒë∆∞·ªùng, ph·ªë (v√≠ d·ª•: Tr·∫ßn H∆∞ng ƒê·∫°o)..." required autocomplete="off">
                </div>
                <button type="submit" id="searchBtn">
                     Tra C·ª©u Ngay
                </button>
            </form>
        </section>

        <!-- Loading & Status -->
        <section id="statusSection" class="status-section hidden">
            <div class="loader-animation"></div>
            <p style="font-weight: 500; color: var(--text-secondary)">ƒêang ƒë·ªìng b·ªô d·ªØ li·ªáu...</p>
        </section>

        <!-- Results -->
        <section id="resultsSection" class="results-section hidden">
            <!-- Content injected via JS -->
        </section>
        
        <!-- Footer -->
        <footer>
            <p>&copy; 2026 HANOI LAND PRICE LOOKUP. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Use the deployed Web App URL
        const APPSCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz35xFNhzZvsYuxxpsxQKveGWNaifMJTCgwF7tS4is1AmU4WnLGC_JjYR3x05Qw1ier/exec';

        const searchForm = document.getElementById('searchForm');
        const searchInput = document.getElementById('streetInput');
        const resultsSection = document.getElementById('resultsSection');
        const statusSection = document.getElementById('statusSection');

        searchForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const query = searchInput.value.trim();
            if (!query) return;

            // Reset UI
            resultsSection.innerHTML = '';
            resultsSection.classList.add('hidden');
            statusSection.classList.remove('hidden');

            try {
                // Fetch Data
                // Note: Apps Script redirect handling is automatic in standard fetch 
                const response = await fetch(`${APPSCRIPT_URL}?ten_duong=${encodeURIComponent(query)}`);
                
                if (!response.ok) {
                    throw new Error('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß d·ªØ li·ªáu (Code 400/500)');
                }
                
                const data = await response.json();
                renderResults(data, query);

            } catch (error) {
                console.error("Fetch Error:", error);
                resultsSection.innerHTML = `
                    <div class="error-msg">
                        <h3><i class="fa-solid fa-triangle-exclamation"></i> L·ªói K·∫øt N·ªëi</h3>
                        <p>Kh√¥ng th·ªÉ l·∫•y d·ªØ li·ªáu l√∫c n√†y. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi m·∫°ng ho·∫∑c th·ª≠ l·∫°i sau.</p>
                        <p style="font-size:0.8rem; margin-top:8px">${error.message}</p>
                    </div>
                `;
                resultsSection.classList.remove('hidden');
            } finally {
                statusSection.classList.add('hidden');
            }
        });

        function renderResults(data, query) {
            resultsSection.classList.remove('hidden');

            if (!data || data.length === 0) {
                resultsSection.innerHTML = `
                    <div class="status-section">
                        <i class="fa-solid fa-inbox" style="font-size: 3rem; color: #cbd5e1; margin-bottom: 16px;"></i>
                        <p style="font-size: 1.1rem; color: #64748b;">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o cho "<strong>${query}</strong>"</p>
                        <p style="font-size: 0.9rem; color: #94a3b8;">H√£y th·ª≠ nh·∫≠p t√™n ƒë∆∞·ªùng ng·∫Øn h∆°n ho·∫∑c ki·ªÉm tra ch√≠nh t·∫£.</p>
                    </div>
                `;
                return;
            }

            // Header info
            let html = `
                <div class="results-header">
                    <div class="results-count">T√¨m th·∫•y <span>${data.length}</span> k·∫øt qu·∫£</div>
                    <div style="font-size: 0.9rem; color: #64748b;"><i class="fa-regular fa-clock"></i> C·∫≠p nh·∫≠t m·ªõi nh·∫•t</div>
                </div>
                <div class="results-grid">
            `;

            // Card Builder
            html += data.map(item => {
                const get = (k) => item[k] || '';
                
                // Helper to format currency/numbers if needed, but data seems pre-formatted with commas
                const formatPop = (v) => v ? `<span class="price-highlight">${v}</span>` : '-';

                return `
                <div class="land-card">
                    <div class="card-top">
                        <div class="street-title">
                            <i class="fa-solid fa-road" style="color: var(--secondary-color)"></i>
                            ${get('T√™n ƒë∆∞·ªùng ph·ªë') || 'Kh√¥ng t√™n'}
                        </div>
                        <span class="location-tag">${get('ƒê·ªãa danh h√†nh ch√≠nh') || 'H√† N·ªôi'}</span>
                    </div>

                    <div class="route-info">
                        <div class="route-point">
                            <span class="point-label"><i class="fa-solid fa-location-dot"></i> ƒêi·ªÉm ƒê·∫ßu</span>
                            <div class="point-value">${get('T·ª´') || '---'}</div>
                        </div>
                        <div class="route-point">
                            <span class="point-label"><i class="fa-solid fa-location-crosshairs"></i> ƒêi·ªÉm Cu·ªëi</span>
                            <div class="point-value">${get('ƒê·∫øn') || '---'}</div>
                        </div>
                    </div>

                    <div class="price-table-wrapper">
                        <table class="price-table">
                            <thead>
                                <tr>
                                    <th>Lo·∫°i ƒê·∫•t</th>
                                    <th>V·ªã Tr√≠ 1</th>
                                    <th>V·ªã Tr√≠ 2</th>
                                    <th>V·ªã Tr√≠ 3</th>
                                    <th>V·ªã Tr√≠ 4</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ƒê·∫•t ·ªû</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t ·ªü - VT1'))}</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t ·ªü - VT2'))}</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t ·ªü - VT3'))}</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t ·ªü - VT4'))}</td>
                                </tr>
                                <tr>
                                    <td>TM-DV</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t th∆∞∆°ng m·∫°i, d·ªãch v·ª• - VT1'))}</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t th∆∞∆°ng m·∫°i, d·ªãch v·ª• - VT2'))}</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t th∆∞∆°ng m·∫°i, d·ªãch v·ª• - VT3'))}</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t th∆∞∆°ng m·∫°i, d·ªãch v·ª• - VT4'))}</td>
                                </tr>
                                <tr>
                                    <td>SX-KD</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t s·∫£n xu·∫•t kinh doanh phi n√¥ng nghi·ªáp kh√¥ng ph·∫£i l√† ƒë·∫•t th∆∞∆°ng m·∫°i d·ªãch v·ª• - VT1'))}</td>
                                    <td>${formatPop(get('Gi√° ƒë·∫•t s·∫£n xu·∫•t kinh doanh phi n√¥ng nghi·ªáp kh√¥ng ph·∫£i l√† ƒë·∫•t th∆∞∆°ng m·∫°i d·ªãch v·ª• - VT2'))}</td>
                                    <td colspan="2" style="text-align:center; color: #cbd5e1">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                `;
            }).join('');

            html += '</div>';
            resultsSection.innerHTML = html;
        }
    </script>
</body>
</html>
